<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安全最佳实践 | 胖虎 博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="胖虎 个人技术博客">
    
    <link rel="preload" href="/blog/assets/css/0.styles.cb1b2027.css" as="style"><link rel="preload" href="/blog/assets/js/app.fec5a153.js" as="script"><link rel="preload" href="/blog/assets/js/2.f2b8224f.js" as="script"><link rel="preload" href="/blog/assets/js/1.57fa854c.js" as="script"><link rel="preload" href="/blog/assets/js/132.f9507210.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.f277d560.js"><link rel="prefetch" href="/blog/assets/js/100.122b9fe5.js"><link rel="prefetch" href="/blog/assets/js/101.f3ff0c58.js"><link rel="prefetch" href="/blog/assets/js/102.d702d04e.js"><link rel="prefetch" href="/blog/assets/js/103.0d0b92b7.js"><link rel="prefetch" href="/blog/assets/js/104.b6b4b18b.js"><link rel="prefetch" href="/blog/assets/js/105.14cf5dc6.js"><link rel="prefetch" href="/blog/assets/js/106.29e7a736.js"><link rel="prefetch" href="/blog/assets/js/107.5809c6f0.js"><link rel="prefetch" href="/blog/assets/js/108.8354843f.js"><link rel="prefetch" href="/blog/assets/js/109.3785d561.js"><link rel="prefetch" href="/blog/assets/js/11.832152cf.js"><link rel="prefetch" href="/blog/assets/js/110.c68231f7.js"><link rel="prefetch" href="/blog/assets/js/111.16187ada.js"><link rel="prefetch" href="/blog/assets/js/112.4cf4515e.js"><link rel="prefetch" href="/blog/assets/js/113.2923b604.js"><link rel="prefetch" href="/blog/assets/js/114.885cd3f8.js"><link rel="prefetch" href="/blog/assets/js/115.40a9759e.js"><link rel="prefetch" href="/blog/assets/js/116.dd8c6b70.js"><link rel="prefetch" href="/blog/assets/js/117.fec0f30d.js"><link rel="prefetch" href="/blog/assets/js/118.20f5bb7f.js"><link rel="prefetch" href="/blog/assets/js/119.847c92d8.js"><link rel="prefetch" href="/blog/assets/js/12.5bdf8e02.js"><link rel="prefetch" href="/blog/assets/js/120.4f17ce44.js"><link rel="prefetch" href="/blog/assets/js/121.b097a0c4.js"><link rel="prefetch" href="/blog/assets/js/122.21d287ac.js"><link rel="prefetch" href="/blog/assets/js/123.ad95000b.js"><link rel="prefetch" href="/blog/assets/js/124.dccd113f.js"><link rel="prefetch" href="/blog/assets/js/125.dc3a51a7.js"><link rel="prefetch" href="/blog/assets/js/126.4c30cdae.js"><link rel="prefetch" href="/blog/assets/js/127.46e83b8d.js"><link rel="prefetch" href="/blog/assets/js/128.7714035d.js"><link rel="prefetch" href="/blog/assets/js/129.2d3dea01.js"><link rel="prefetch" href="/blog/assets/js/13.09410521.js"><link rel="prefetch" href="/blog/assets/js/130.52d53c86.js"><link rel="prefetch" href="/blog/assets/js/131.a9219374.js"><link rel="prefetch" href="/blog/assets/js/133.eef4a605.js"><link rel="prefetch" href="/blog/assets/js/134.1ec8ede0.js"><link rel="prefetch" href="/blog/assets/js/135.c515a775.js"><link rel="prefetch" href="/blog/assets/js/136.c5bd8358.js"><link rel="prefetch" href="/blog/assets/js/137.f070acdb.js"><link rel="prefetch" href="/blog/assets/js/138.cd73a0fe.js"><link rel="prefetch" href="/blog/assets/js/139.fb21488a.js"><link rel="prefetch" href="/blog/assets/js/14.1f0cfc71.js"><link rel="prefetch" href="/blog/assets/js/140.c1fb5ff3.js"><link rel="prefetch" href="/blog/assets/js/141.a0cba179.js"><link rel="prefetch" href="/blog/assets/js/142.a82629a2.js"><link rel="prefetch" href="/blog/assets/js/143.1aa7d019.js"><link rel="prefetch" href="/blog/assets/js/144.64eaf9a4.js"><link rel="prefetch" href="/blog/assets/js/145.266a35b6.js"><link rel="prefetch" href="/blog/assets/js/146.665a0745.js"><link rel="prefetch" href="/blog/assets/js/147.99e60d93.js"><link rel="prefetch" href="/blog/assets/js/148.946ae795.js"><link rel="prefetch" href="/blog/assets/js/149.0cc4cc5a.js"><link rel="prefetch" href="/blog/assets/js/15.5b0c6b3a.js"><link rel="prefetch" href="/blog/assets/js/150.617c13a2.js"><link rel="prefetch" href="/blog/assets/js/151.c2305bac.js"><link rel="prefetch" href="/blog/assets/js/152.df8c8775.js"><link rel="prefetch" href="/blog/assets/js/153.9ca800df.js"><link rel="prefetch" href="/blog/assets/js/154.1925d7b8.js"><link rel="prefetch" href="/blog/assets/js/155.c643e691.js"><link rel="prefetch" href="/blog/assets/js/156.4e844cff.js"><link rel="prefetch" href="/blog/assets/js/157.8bc7d1a5.js"><link rel="prefetch" href="/blog/assets/js/158.379c686b.js"><link rel="prefetch" href="/blog/assets/js/159.c04fb9cb.js"><link rel="prefetch" href="/blog/assets/js/16.83686824.js"><link rel="prefetch" href="/blog/assets/js/160.fbe22be1.js"><link rel="prefetch" href="/blog/assets/js/161.7a026687.js"><link rel="prefetch" href="/blog/assets/js/162.d7125f81.js"><link rel="prefetch" href="/blog/assets/js/163.04c8df9a.js"><link rel="prefetch" href="/blog/assets/js/164.d39152eb.js"><link rel="prefetch" href="/blog/assets/js/165.3006b8eb.js"><link rel="prefetch" href="/blog/assets/js/166.8f03a4b5.js"><link rel="prefetch" href="/blog/assets/js/167.2a96bb7e.js"><link rel="prefetch" href="/blog/assets/js/168.c9b8ad67.js"><link rel="prefetch" href="/blog/assets/js/169.5c660028.js"><link rel="prefetch" href="/blog/assets/js/17.8e1a6509.js"><link rel="prefetch" href="/blog/assets/js/170.7ab6d594.js"><link rel="prefetch" href="/blog/assets/js/171.a5b5374f.js"><link rel="prefetch" href="/blog/assets/js/172.8a9007fe.js"><link rel="prefetch" href="/blog/assets/js/173.d64d24cf.js"><link rel="prefetch" href="/blog/assets/js/174.98ace633.js"><link rel="prefetch" href="/blog/assets/js/175.3f37f502.js"><link rel="prefetch" href="/blog/assets/js/176.6065c67d.js"><link rel="prefetch" href="/blog/assets/js/177.d9adba45.js"><link rel="prefetch" href="/blog/assets/js/178.3ccc5388.js"><link rel="prefetch" href="/blog/assets/js/179.46fb5d97.js"><link rel="prefetch" href="/blog/assets/js/18.105ba92d.js"><link rel="prefetch" href="/blog/assets/js/180.4c470485.js"><link rel="prefetch" href="/blog/assets/js/181.ae655998.js"><link rel="prefetch" href="/blog/assets/js/182.ee40ab7b.js"><link rel="prefetch" href="/blog/assets/js/183.71c771cc.js"><link rel="prefetch" href="/blog/assets/js/184.484a5ff5.js"><link rel="prefetch" href="/blog/assets/js/185.73394687.js"><link rel="prefetch" href="/blog/assets/js/186.454ff873.js"><link rel="prefetch" href="/blog/assets/js/187.ebadc24a.js"><link rel="prefetch" href="/blog/assets/js/188.f596414a.js"><link rel="prefetch" href="/blog/assets/js/189.7b509849.js"><link rel="prefetch" href="/blog/assets/js/19.6d3610bc.js"><link rel="prefetch" href="/blog/assets/js/190.5a650361.js"><link rel="prefetch" href="/blog/assets/js/191.d4302205.js"><link rel="prefetch" href="/blog/assets/js/192.e01e93bd.js"><link rel="prefetch" href="/blog/assets/js/193.c692bd57.js"><link rel="prefetch" href="/blog/assets/js/194.08ae0006.js"><link rel="prefetch" href="/blog/assets/js/195.c009bea2.js"><link rel="prefetch" href="/blog/assets/js/196.2a7aae9d.js"><link rel="prefetch" href="/blog/assets/js/197.fa77b7c7.js"><link rel="prefetch" href="/blog/assets/js/198.c9013b85.js"><link rel="prefetch" href="/blog/assets/js/199.4b3e27e4.js"><link rel="prefetch" href="/blog/assets/js/20.53600d06.js"><link rel="prefetch" href="/blog/assets/js/200.306720ea.js"><link rel="prefetch" href="/blog/assets/js/201.75b9586b.js"><link rel="prefetch" href="/blog/assets/js/202.e5a2721e.js"><link rel="prefetch" href="/blog/assets/js/203.b6a17621.js"><link rel="prefetch" href="/blog/assets/js/204.71e7cabb.js"><link rel="prefetch" href="/blog/assets/js/205.1cd4da19.js"><link rel="prefetch" href="/blog/assets/js/206.d3364d3d.js"><link rel="prefetch" href="/blog/assets/js/207.bd5ada19.js"><link rel="prefetch" href="/blog/assets/js/208.dc3ffbbf.js"><link rel="prefetch" href="/blog/assets/js/209.c3eec430.js"><link rel="prefetch" href="/blog/assets/js/21.ce3bb583.js"><link rel="prefetch" href="/blog/assets/js/210.26e6fd1c.js"><link rel="prefetch" href="/blog/assets/js/211.303ba7cc.js"><link rel="prefetch" href="/blog/assets/js/212.7c88f3c4.js"><link rel="prefetch" href="/blog/assets/js/213.9e8e6ec7.js"><link rel="prefetch" href="/blog/assets/js/214.148aa0a6.js"><link rel="prefetch" href="/blog/assets/js/215.2a498f26.js"><link rel="prefetch" href="/blog/assets/js/216.8a173ea4.js"><link rel="prefetch" href="/blog/assets/js/217.04b0b67a.js"><link rel="prefetch" href="/blog/assets/js/218.320ef1a7.js"><link rel="prefetch" href="/blog/assets/js/219.1f2fe668.js"><link rel="prefetch" href="/blog/assets/js/22.7fd0800c.js"><link rel="prefetch" href="/blog/assets/js/220.62614bdc.js"><link rel="prefetch" href="/blog/assets/js/23.7eb81949.js"><link rel="prefetch" href="/blog/assets/js/24.a78b6826.js"><link rel="prefetch" href="/blog/assets/js/25.a3d7cba6.js"><link rel="prefetch" href="/blog/assets/js/26.d1ded3a0.js"><link rel="prefetch" href="/blog/assets/js/27.36396f57.js"><link rel="prefetch" href="/blog/assets/js/28.9f551bd2.js"><link rel="prefetch" href="/blog/assets/js/29.694aa61d.js"><link rel="prefetch" href="/blog/assets/js/3.5ce4ea28.js"><link rel="prefetch" href="/blog/assets/js/30.67cdf45a.js"><link rel="prefetch" href="/blog/assets/js/31.6a36e373.js"><link rel="prefetch" href="/blog/assets/js/32.9fdf7ffb.js"><link rel="prefetch" href="/blog/assets/js/33.1d806434.js"><link rel="prefetch" href="/blog/assets/js/34.f20a92de.js"><link rel="prefetch" href="/blog/assets/js/35.b306d308.js"><link rel="prefetch" href="/blog/assets/js/36.df77e06d.js"><link rel="prefetch" href="/blog/assets/js/37.a1e14130.js"><link rel="prefetch" href="/blog/assets/js/38.32e868cd.js"><link rel="prefetch" href="/blog/assets/js/39.f11a62e1.js"><link rel="prefetch" href="/blog/assets/js/4.ee0de53f.js"><link rel="prefetch" href="/blog/assets/js/40.7d5864b0.js"><link rel="prefetch" href="/blog/assets/js/41.d53ea2e7.js"><link rel="prefetch" href="/blog/assets/js/42.885e7c56.js"><link rel="prefetch" href="/blog/assets/js/43.08b08dba.js"><link rel="prefetch" href="/blog/assets/js/44.39b279cd.js"><link rel="prefetch" href="/blog/assets/js/45.9a9c848f.js"><link rel="prefetch" href="/blog/assets/js/46.d7019977.js"><link rel="prefetch" href="/blog/assets/js/47.5681f4bb.js"><link rel="prefetch" href="/blog/assets/js/48.b1388b5e.js"><link rel="prefetch" href="/blog/assets/js/49.eef0b81b.js"><link rel="prefetch" href="/blog/assets/js/5.68a4f8c1.js"><link rel="prefetch" href="/blog/assets/js/50.51247f23.js"><link rel="prefetch" href="/blog/assets/js/51.62cf0dc3.js"><link rel="prefetch" href="/blog/assets/js/52.0e35e535.js"><link rel="prefetch" href="/blog/assets/js/53.e21249df.js"><link rel="prefetch" href="/blog/assets/js/54.6007c0a6.js"><link rel="prefetch" href="/blog/assets/js/55.f86cddbc.js"><link rel="prefetch" href="/blog/assets/js/56.23ae9fdf.js"><link rel="prefetch" href="/blog/assets/js/57.8413e6fc.js"><link rel="prefetch" href="/blog/assets/js/58.50d179f0.js"><link rel="prefetch" href="/blog/assets/js/59.6b697e61.js"><link rel="prefetch" href="/blog/assets/js/6.f20b43ab.js"><link rel="prefetch" href="/blog/assets/js/60.0d3785d6.js"><link rel="prefetch" href="/blog/assets/js/61.d3ca9add.js"><link rel="prefetch" href="/blog/assets/js/62.687343b3.js"><link rel="prefetch" href="/blog/assets/js/63.c4ba5928.js"><link rel="prefetch" href="/blog/assets/js/64.6f085eec.js"><link rel="prefetch" href="/blog/assets/js/65.a9f669ea.js"><link rel="prefetch" href="/blog/assets/js/66.2f16d9e1.js"><link rel="prefetch" href="/blog/assets/js/67.495ef8c0.js"><link rel="prefetch" href="/blog/assets/js/68.e35f574a.js"><link rel="prefetch" href="/blog/assets/js/69.b05df3a3.js"><link rel="prefetch" href="/blog/assets/js/7.67164775.js"><link rel="prefetch" href="/blog/assets/js/70.59df9777.js"><link rel="prefetch" href="/blog/assets/js/71.28a02164.js"><link rel="prefetch" href="/blog/assets/js/72.56ab2e25.js"><link rel="prefetch" href="/blog/assets/js/73.3287fa7e.js"><link rel="prefetch" href="/blog/assets/js/74.35996075.js"><link rel="prefetch" href="/blog/assets/js/75.a762bdf2.js"><link rel="prefetch" href="/blog/assets/js/76.34a3289f.js"><link rel="prefetch" href="/blog/assets/js/77.34a980e8.js"><link rel="prefetch" href="/blog/assets/js/78.bad8d2b3.js"><link rel="prefetch" href="/blog/assets/js/79.0b3004f8.js"><link rel="prefetch" href="/blog/assets/js/80.3badf199.js"><link rel="prefetch" href="/blog/assets/js/81.9a549ea0.js"><link rel="prefetch" href="/blog/assets/js/82.3c8a2cc8.js"><link rel="prefetch" href="/blog/assets/js/83.645eaf44.js"><link rel="prefetch" href="/blog/assets/js/84.5af9ab77.js"><link rel="prefetch" href="/blog/assets/js/85.36bb7abd.js"><link rel="prefetch" href="/blog/assets/js/86.103e08ce.js"><link rel="prefetch" href="/blog/assets/js/87.043852ed.js"><link rel="prefetch" href="/blog/assets/js/88.20bb8667.js"><link rel="prefetch" href="/blog/assets/js/89.daa6770a.js"><link rel="prefetch" href="/blog/assets/js/90.386bc9ee.js"><link rel="prefetch" href="/blog/assets/js/91.7d60d5a1.js"><link rel="prefetch" href="/blog/assets/js/92.09d8e05e.js"><link rel="prefetch" href="/blog/assets/js/93.c8f19bb1.js"><link rel="prefetch" href="/blog/assets/js/94.524fac30.js"><link rel="prefetch" href="/blog/assets/js/95.ea7ea2db.js"><link rel="prefetch" href="/blog/assets/js/96.f5d892d1.js"><link rel="prefetch" href="/blog/assets/js/97.59bce9b8.js"><link rel="prefetch" href="/blog/assets/js/98.40eb9585.js"><link rel="prefetch" href="/blog/assets/js/99.535b0633.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.34c2b646.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.cb1b2027.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">胖虎 博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/frontend/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/js/" class="nav-link router-link-active">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/ts/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/jquery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/animation/" class="nav-link">
  动画
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/uni-app/" class="nav-link">
  uni-app
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/weixin/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/node/" class="nav-link">
  Node.js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="UI" class="dropdown-title"><span class="title">UI</span> <span class="arrow down"></span></button> <button type="button" aria-label="UI" class="mobile-dropdown-title"><span class="title">UI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ui/" class="nav-link">
  设计规范
</a></li><li class="dropdown-item"><!----> <a href="https://fzx19980425.github.io/ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  设计组件
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fzx19980425" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/fzx0425" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1900382830734376" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/frontend/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/js/" class="nav-link router-link-active">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/ts/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/jquery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/animation/" class="nav-link">
  动画
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/uni-app/" class="nav-link">
  uni-app
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/weixin/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/blog/frontend/node/" class="nav-link">
  Node.js
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="UI" class="dropdown-title"><span class="title">UI</span> <span class="arrow down"></span></button> <button type="button" aria-label="UI" class="mobile-dropdown-title"><span class="title">UI</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ui/" class="nav-link">
  设计规范
</a></li><li class="dropdown-item"><!----> <a href="https://fzx19980425.github.io/ui/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  设计组件
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于我" class="dropdown-title"><span class="title">关于我</span> <span class="arrow down"></span></button> <button type="button" aria-label="关于我" class="mobile-dropdown-title"><span class="title">关于我</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fzx19980425" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/fzx0425" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1900382830734376" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript 基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript 进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript 工程化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/frontend/js/tools.html" class="sidebar-link">开发工具</a></li><li><a href="/blog/frontend/js/debugging.html" class="sidebar-link">调试技巧</a></li><li><a href="/blog/frontend/js/testing.html" class="sidebar-link">单元测试</a></li><li><a href="/blog/frontend/js/performance.html" class="sidebar-link">性能优化</a></li><li><a href="/blog/frontend/js/security.html" aria-current="page" class="active sidebar-link">安全最佳实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#常见安全威胁" class="sidebar-link">常见安全威胁</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#数据安全" class="sidebar-link">数据安全</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#安全编码实践" class="sidebar-link">安全编码实践</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#安全最佳实践-2" class="sidebar-link">安全最佳实践</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#安全测试" class="sidebar-link">安全测试</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#安全监控和响应" class="sidebar-link">安全监控和响应</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#最佳实践总结" class="sidebar-link">最佳实践总结</a></li><li class="sidebar-sub-header"><a href="/blog/frontend/js/security.html#相关资源" class="sidebar-link">相关资源</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="安全最佳实践"><a href="#安全最佳实践" class="header-anchor">#</a> 安全最佳实践</h1> <h2 id="常见安全威胁"><a href="#常见安全威胁" class="header-anchor">#</a> 常见安全威胁</h2> <h3 id="_1-xss-跨站脚本攻击"><a href="#_1-xss-跨站脚本攻击" class="header-anchor">#</a> 1. XSS（跨站脚本攻击）</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token keyword">function</span> <span class="token function">displayUserInput</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 错误：直接插入用户输入</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> input<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 安全的代码</span>
<span class="token keyword">function</span> <span class="token function">displayUserInput</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 正确：使用 textContent 或转义</span>
    <span class="token keyword">const</span> output <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    output<span class="token punctuation">.</span>textContent <span class="token operator">=</span> input<span class="token punctuation">;</span>
    
    <span class="token comment">// 或者使用 HTML 转义</span>
    output<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">escapeHtml</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// HTML 转义函数</span>
<span class="token keyword">function</span> <span class="token function">escapeHtml</span><span class="token punctuation">(</span><span class="token parameter">unsafe</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> unsafe
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&amp;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;amp;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;lt;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;gt;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&quot;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">'</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;#039;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-csrf-跨站请求伪造"><a href="#_2-csrf-跨站请求伪造" class="header-anchor">#</a> 2. CSRF（跨站请求伪造）</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/transfer'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">'attacker'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 安全的代码</span>
<span class="token comment">// 1. 使用 CSRF Token</span>
<span class="token keyword">const</span> csrfToken <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'meta[name=&quot;csrf-token&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/transfer'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'X-CSRF-Token'</span><span class="token operator">:</span> csrfToken
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
        <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">'recipient'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 使用 SameSite Cookie</span>
<span class="token comment">// 在服务器端设置</span>
<span class="token comment">// Set-Cookie: sessionId=abc123; SameSite=Strict</span>
</code></pre></div><h3 id="_3-点击劫持"><a href="#_3-点击劫持" class="header-anchor">#</a> 3. 点击劫持</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 不安全的代码 --&gt;</span>
<span class="token comment">&lt;!-- 允许在 iframe 中嵌入 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-Frame-Options<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ALLOW-FROM *<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 安全的代码 --&gt;</span>
<span class="token comment">&lt;!-- 禁止在 iframe 中嵌入 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-Frame-Options<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 或者使用 CSP --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Security-Policy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>frame-ancestors 'none'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="数据安全"><a href="#数据安全" class="header-anchor">#</a> 数据安全</h2> <h3 id="_1-敏感数据处理"><a href="#_1-敏感数据处理" class="header-anchor">#</a> 1. 敏感数据处理</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token comment">// 在 URL 中传递敏感数据</span>
window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/user/profile?token=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 安全的代码</span>
<span class="token comment">// 使用 POST 请求和 HTTPS</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/user/profile'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
            <span class="token string-property property">'Authorization'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userToken<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">'same-origin'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 密码处理</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">hashPassword</span><span class="token punctuation">(</span><span class="token parameter">password</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用 Web Crypto API</span>
    <span class="token keyword">const</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token keyword">await</span> crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'SHA-256'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">b</span> <span class="token operator">=&gt;</span> b<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-本地存储安全"><a href="#_2-本地存储安全" class="header-anchor">#</a> 2. 本地存储安全</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token comment">// 在 localStorage 中存储敏感数据</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'userToken'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 安全的代码</span>
<span class="token comment">// 使用 sessionStorage（会话结束时清除）</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'userToken'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 或者使用 HttpOnly Cookie</span>
<span class="token comment">// 在服务器端设置</span>
<span class="token comment">// Set-Cookie: token=abc123; HttpOnly; Secure; SameSite=Strict</span>

<span class="token comment">// 加密存储</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">secureStorage</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token keyword">await</span> crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;AES-GCM&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">256</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&quot;encrypt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;decrypt&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> iv <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> encrypted <span class="token operator">=</span> <span class="token keyword">await</span> crypto<span class="token punctuation">.</span>subtle<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;AES-GCM&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">iv</span><span class="token operator">:</span> iv
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        key<span class="token punctuation">,</span>
        data
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">iv</span><span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="安全编码实践"><a href="#安全编码实践" class="header-anchor">#</a> 安全编码实践</h2> <h3 id="_1-输入验证"><a href="#_1-输入验证" class="header-anchor">#</a> 1. 输入验证</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token keyword">function</span> <span class="token function">processUserInput</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 直接使用用户输入</span>
    <span class="token function">eval</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 安全的代码</span>
<span class="token keyword">function</span> <span class="token function">validateInput</span><span class="token punctuation">(</span><span class="token parameter">input<span class="token punctuation">,</span> schema</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用验证库（如 Joi、Yup）</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> schema<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'输入验证失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 示例：使用 Joi</span>
<span class="token keyword">const</span> Joi <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'joi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> userSchema <span class="token operator">=</span> Joi<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">username</span><span class="token operator">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alphanum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">email</span><span class="token operator">:</span> Joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> Joi<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">integer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">validateUser</span><span class="token punctuation">(</span><span class="token parameter">userData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userSchema<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>userData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-输出编码"><a href="#_2-输出编码" class="header-anchor">#</a> 2. 输出编码</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token keyword">function</span> <span class="token function">displayUserData</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div&gt;用户名：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;
        &lt;div&gt;邮箱：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>email<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 安全的代码</span>
<span class="token keyword">function</span> <span class="token function">displayUserData</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userInfo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> nameDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> emailDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    nameDiv<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">用户名：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    emailDiv<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">邮箱：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>email<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    
    userInfo<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>nameDiv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    userInfo<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>emailDiv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用模板引擎（如 Handlebars）</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> Handlebars<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;用户名：{{name}}&lt;/div&gt;
    &lt;div&gt;邮箱：{{email}}&lt;/div&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">displayUserData</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> Handlebars<span class="token punctuation">.</span><span class="token function">escapeExpression</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">email</span><span class="token operator">:</span> Handlebars<span class="token punctuation">.</span><span class="token function">escapeExpression</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-安全配置"><a href="#_3-安全配置" class="header-anchor">#</a> 3. 安全配置</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 不安全的代码</span>
<span class="token comment">// 暴露敏感配置</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">apiKey</span><span class="token operator">:</span> <span class="token string">'secret-key'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'db-password'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 安全的代码</span>
<span class="token comment">// 使用环境变量</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">apiKey</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">API_KEY</span><span class="token punctuation">,</span>
    <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">host</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DB_HOST</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DB_PASSWORD</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 使用配置文件</span>
<span class="token comment">// config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">development</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">apiUrl</span><span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">production</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">apiUrl</span><span class="token operator">:</span> <span class="token string">'https://api.example.com'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">||</span> <span class="token string">'development'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="安全最佳实践-2"><a href="#安全最佳实践-2" class="header-anchor">#</a> 安全最佳实践</h2> <h3 id="_1-内容安全策略-csp"><a href="#_1-内容安全策略-csp" class="header-anchor">#</a> 1. 内容安全策略（CSP）</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 配置 CSP --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Security-Policy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>
    default-src 'self';
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://trusted-cdn.com;
    style-src 'self' 'unsafe-inline' https://trusted-cdn.com;
    img-src 'self' data: https://trusted-cdn.com;
    connect-src 'self' https://api.example.com;
    font-src 'self' https://trusted-cdn.com;
    object-src 'none';
    media-src 'self';
    frame-src 'none';
<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2-安全头部"><a href="#_2-安全头部" class="header-anchor">#</a> 2. 安全头部</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 在服务器端设置安全头部</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">helmet</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">contentSecurityPolicy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">defaultSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">scriptSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;'unsafe-inline'&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">styleSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;'unsafe-inline'&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">imgSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;data:&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https:&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">connectSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://api.example.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fontSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://fonts.gstatic.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">objectSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'none'&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">mediaSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'self'&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">frameSrc</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;'none'&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">xssFilter</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">noSniff</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">referrerPolicy</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">policy</span><span class="token operator">:</span> <span class="token string">'same-origin'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hsts</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">maxAge</span><span class="token operator">:</span> <span class="token number">31536000</span><span class="token punctuation">,</span>
        <span class="token literal-property property">includeSubDomains</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">preload</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-安全依赖管理"><a href="#_3-安全依赖管理" class="header-anchor">#</a> 3. 安全依赖管理</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;audit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm audit&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;audit:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm audit fix&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outdated&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm outdated&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;express&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.17.1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;helmet&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.6.0&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;snyk&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.0&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="安全测试"><a href="#安全测试" class="header-anchor">#</a> 安全测试</h2> <h3 id="_1-自动化安全测试"><a href="#_1-自动化安全测试" class="header-anchor">#</a> 1. 自动化安全测试</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 使用 OWASP ZAP 进行安全测试</span>
<span class="token comment">// zap-cli quick-scan --self-contained --start-options &quot;-config api.disablekey=true&quot; http://localhost:3000</span>

<span class="token comment">// 使用 Snyk 进行依赖检查</span>
<span class="token comment">// snyk test</span>

<span class="token comment">// 使用 ESLint 安全插件</span>
<span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'security'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'plugin:security/recommended'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'security/detect-object-injection'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'security/detect-non-literal-regexp'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'security/detect-unsafe-regex'</span><span class="token operator">:</span> <span class="token string">'error'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-手动安全测试"><a href="#_2-手动安全测试" class="header-anchor">#</a> 2. 手动安全测试</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// XSS 测试</span>
<span class="token keyword">const</span> xssTests <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'&lt;script&gt;alert(1)&lt;/script&gt;'</span><span class="token punctuation">,</span>
    <span class="token string">'&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;'</span><span class="token punctuation">,</span>
    <span class="token string">'&quot;&gt;&lt;img src=x onerror=alert(1)&gt;'</span><span class="token punctuation">,</span>
    <span class="token string">'javascript:alert(1)'</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// CSRF 测试</span>
<span class="token comment">// 1. 检查是否使用 CSRF Token</span>
<span class="token comment">// 2. 验证 Token 是否正确</span>
<span class="token comment">// 3. 测试 Token 过期处理</span>

<span class="token comment">// 点击劫持测试</span>
<span class="token comment">// 1. 检查 X-Frame-Options 头部</span>
<span class="token comment">// 2. 验证 CSP frame-ancestors 指令</span>
</code></pre></div><h2 id="安全监控和响应"><a href="#安全监控和响应" class="header-anchor">#</a> 安全监控和响应</h2> <h3 id="_1-错误监控"><a href="#_1-错误监控" class="header-anchor">#</a> 1. 错误监控</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 使用 Sentry 进行错误监控</span>
Sentry<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">dsn</span><span class="token operator">:</span> <span class="token string">&quot;https://example@sentry.io/123&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">environment</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">,</span>
    <span class="token literal-property property">release</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">,</span>
    <span class="token function">beforeSend</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 过滤敏感信息</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> event<span class="token punctuation">.</span>user<span class="token punctuation">.</span>email<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> event<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 自定义错误处理</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> source<span class="token punctuation">,</span> lineno<span class="token punctuation">,</span> colno<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 记录错误</span>
    Sentry<span class="token punctuation">.</span><span class="token function">captureException</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 阻止默认错误处理</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-安全日志"><a href="#_2-安全日志" class="header-anchor">#</a> 2. 安全日志</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 记录安全事件</span>
<span class="token keyword">function</span> <span class="token function">logSecurityEvent</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> logEntry <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">timestamp</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">event</span><span class="token operator">:</span> event<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
        <span class="token literal-property property">user</span><span class="token operator">:</span> event<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
        <span class="token literal-property property">ip</span><span class="token operator">:</span> event<span class="token punctuation">.</span>ip<span class="token punctuation">,</span>
        <span class="token literal-property property">userAgent</span><span class="token operator">:</span> event<span class="token punctuation">.</span>userAgent<span class="token punctuation">,</span>
        <span class="token literal-property property">details</span><span class="token operator">:</span> event<span class="token punctuation">.</span>details
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 发送到日志服务器</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/logs/security'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>logEntry<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用示例</span>
<span class="token function">logSecurityEvent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'login_failure'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ip</span><span class="token operator">:</span> <span class="token string">'192.168.1.1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">userAgent</span><span class="token operator">:</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">,</span>
    <span class="token literal-property property">details</span><span class="token operator">:</span> <span class="token string">'Invalid password'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="最佳实践总结"><a href="#最佳实践总结" class="header-anchor">#</a> 最佳实践总结</h2> <ol><li>始终验证和清理用户输入</li> <li>使用 HTTPS 传输数据</li> <li>实施适当的内容安全策略</li> <li>保护敏感数据</li> <li>定期更新依赖</li> <li>进行安全测试</li> <li>监控安全事件</li> <li>保持安全日志</li></ol> <h2 id="相关资源"><a href="#相关资源" class="header-anchor">#</a> 相关资源</h2> <ul><li><a href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer">OWASP 安全指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security" target="_blank" rel="noopener noreferrer">MDN 安全指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP" target="_blank" rel="noopener noreferrer">Content Security Policy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Securing_your_site" target="_blank" rel="noopener noreferrer">Web 安全最佳实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">6/1/2025, 12:22:53 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/frontend/js/performance.html" class="prev">
        性能优化
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.fec5a153.js" defer></script><script src="/blog/assets/js/2.f2b8224f.js" defer></script><script src="/blog/assets/js/1.57fa854c.js" defer></script><script src="/blog/assets/js/132.f9507210.js" defer></script>
  </body>
</html>
